---
title: "Problema4"
author: "Jefferson,Ricardo"
date: "2025-09-22"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Estimación de intervalos de confianza
Una empresa dedicada a la generación de energía renovable desea evaluar el rendimiento de sus 20 generadores eléctricos portátiles, alimentados con biocombustible. Estos generadores se utilizan en proyectos remotos, donde la eficiencia energética es crucial para minimizar costos y reducir la huella ambiental. Para el estudio, se mide la eficiencia energética de cada generador, expresada en kilovatios-hora por litro de combustible (kWh/L). Los resultados son:

# Muestra de eficiencia energética (kWh/L)
muestra <- c(6.12, 5.87, 5.45, 6.33, 5.71, 6.04, 5.92, 5.65, 6.18, 
             5.78, 5.95, 6.21, 5.63, 5.79, 6.11, 5.88, 6.02, 5.76, 5.85, 6.10)
El objetivo es determinar intervalos de confianza al 95% para la eficiencia media.

```{r}

# Datos
muestra <- c(6.12, 5.87, 5.45, 6.33, 5.71, 6.04, 5.92, 5.65, 6.18, 
             5.78, 5.95, 6.21, 5.63, 5.79, 6.11, 5.88, 6.02, 5.76, 5.85, 6.10)

n <- length(muestra)
media <- mean(muestra)
sd_muestra <- sd(muestra)

print(media)
print(sd_muestra)

```
La media muestral es de 5.9175 kWh/L y la desviacion es de 0.2232.

Normalidad:

```{r Figura I,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE}

library(ggplot2)

df <- data.frame(muestra=muestra)

ggplot(df, aes(x=muestra)) +
  geom_histogram(aes(y=..density..), bins=8, fill="skyblue", color="black") +
  geom_density(color="red", size=1) +
  labs(title="Histograma y densidad de la muestra",
       x="Eficiencia (kWh/L)", y="Densidad") +
  theme_bw(base_size=12)


```

**Figura I Histograma y Densidad de la muestra**

A pesar que el histograma Figura I nos muestra una grafica similar a la de una distribución normal no es exactamente simetrica, visualmente podemos analizar que como tal no hay una fuerte desviación pero lo corroboraremos con la prueba de shapiro en donde nuestra hipotesis es que los datos provienen de una poblacion normal si p>0.05 no se rechaza la hipotesis, la hipotesis alternativa es que los datos no provienen de una distribución normal.

```{r Resultados,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE}


shapiro.test(muestra)      # Shapiro–Wilk

        
```
ya que p=0.99>0.05 no se rechaza la normalidad y por lo tanto es valido usar metodos parametricos para calcular los intervalos de confianza.

```{r resultados 1,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE}

error_est <- qt(0.975, df=n-1) * sd_muestra/sqrt(n)
IC_t <- c(media - error_est, media + error_est)
IC_t


```
Calculamos un intervalo de confianza al 95% esto nos indica que si realizaramos el muestreo repetidas veces y calcularamos siempre el 95% de los intervalos contendrian la media poblacional real y eficiencia media de todos los generadores. La media muestral fue de 5.92 KWh/L y el IC=5.81-6.02kWh/L
Por lo tanto la eficiencia "real" media del consumo esta dentro del rango de IC

```{r resultados 2,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE}
set.seed(123)
B <- 2000
boot_means <- replicate(B, mean(sample(muestra, replace=TRUE)))
IC_boot_percentil <- quantile(boot_means, c(0.025, 0.975))

```

```{r resultados 3,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE}
library(boot)

# función para media
media_fn <- function(data, i) mean(data[i])

boot_obj <- boot(data=muestra, statistic=media_fn, R=2000)

# IC BCa
IC_boot_BCa <- boot.ci(boot_obj, type=c("bca"))

```

```{r resultados 4,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE}
IC_boot_percentil
IC_boot_BCa

```
Los tres intervalos que realizamos son similares y estan centrados alrededor de la media estan muy cerca del rango a pesar de que el parametrico es un poco mas ancho, Bootstrap percentil y BCa son casi identicos y la muestra en ese sentido no tiene un sesgo grande.

Las diferencias rondan alrededor del 0.01 dejando de ser significativas y reflejando tal vez el ajuste del metodo, ver Tabla I

**Tabla I Metodo vs Intervalo de confianza**

| Método                          | Intervalo de Confianza (95%) |
|---------------------------------|------------------------------|
| Paramétrico (t-Student)         | [5.813, 6.022]              |
| Bootstrap Percentil (2.5%–97.5%)| [5.826, 6.013]              |
| Bootstrap BCa                   | [5.825, 6.010]              |
